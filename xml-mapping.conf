# XML Mapping configuration
#
# the configuration section matching the root element of the XML is used
# e.g. the root element for JATS documents is 'article'
#
# the namespace is removed from elements to make xpaths simpler

[article]
title = front/article-meta/title-group/article-title
abstract = front/article-meta/abstract

first_author_surname = jats-authors(.)[1]/name/surname
author_surnames = jats-authors(.)/name/surname

first_author_given_name = jats-authors(.)[1]/name/given-names
author_given_names = jats-authors(.)/name/given-names

first_author_full_name = jats-full-name(jats-authors(.)[1])
author_full_names = jats-full-name(jats-authors(.))

affiliation_text = generic-normalized-text-content(front//aff)
affiliation_strings = jats-aff-string(front//aff)
affiliation_institution = generic-join-children(front//aff, 'institution', ', ')

first_reference_text = generic-normalized-text-content(back//ref[1])
first_reference_fields = generic-as-items(back//ref[1], './/*')
first_reference_author_surnames = generic-as-items(back//ref[1], './/surname')
first_reference_author_given_names = generic-as-items(back//ref[1], './/given-names')
first_reference_author_full_names = generic-as-items(back//ref[1], 'jats-full-name(jats-ref-authors(.))')
first_reference_title = generic-join-children(back//ref[1], './/*[self::article-title or self::chapter-title]', ', ')
first_reference_year = generic-join-children(back//ref[1], './/year', ', ')
first_reference_source = generic-join-children(back//ref[1], './/source', ', ')
first_reference_publication_type = generic-join-children(back//ref[1], './*/@publication-type', ' ')
first_reference_volume = generic-join-children(back//ref[1], './/volume', ', ')
first_reference_fpage = jats-ref-fpage(back//ref[1])
first_reference_lpage = jats-ref-lpage(back//ref[1])

reference_text = generic-normalized-text-content(back//ref)
reference_fields = generic-as-items(back//ref, './/*')
reference_author_surnames = generic-as-items(back//ref, './/surname')
reference_author_given_names = generic-as-items(back//ref, './/given-names')
reference_author_full_names = generic-as-items(back//ref, 'jats-full-name(jats-ref-authors(.))')
reference_title = generic-join-children(back//ref, './/*[self::article-title or self::chapter-title]', ', ')
reference_year = generic-join-children(back//ref, './/year', ', ')
reference_source = generic-join-children(back//ref, './/source', ', ')
reference_publication_type = generic-join-children(back//ref, './*/@publication-type', ' ')
reference_volume = generic-join-children(back//ref, './/volume', ', ')
reference_fpage = jats-ref-fpage(back//ref)
reference_lpage = jats-ref-lpage(back//ref)

keywords = front/article-meta/kwd-group/kwd

section_titles = body//sec/title
section_paragraphs = body//sec/p

tables = body//table-wrap/table
table_strings = generic-text-content(body//table-wrap/table)
table_labels = body//table-wrap/label
table_captions = body//table-wrap/caption
table_label_captions = generic-concat-children(body//table-wrap, '$label', ' ', '$caption')

figure_labels = body//fig/label
figure_captions = body//fig/caption
figure_label_captions = generic-concat-children(body//fig, '$label', ' ', '$caption')


[TEI]
title = teiHeader/fileDesc/titleStmt/title
abstract = tei-abstract-text(teiHeader/profileDesc/abstract)

first_author_surname = tei-authors(.)[1]/persName/surname
author_surnames = tei-authors(.)/persName/surname

first_author_given_name = tei-given-name(tei-authors(.)[1])
author_given_names = tei-given-name(tei-authors(.))

first_author_full_name = tei-full-name(tei-authors(.)[1])
author_full_names = tei-full-name(tei-authors(.))

affiliation_text = tei-aff-text(tei-author-affiliations(.))
affiliation_strings = tei-aff-string(tei-author-affiliations(.))
affiliation_institution = generic-join-children(tei-author-affiliations(.), 'orgName', ', ')

first_reference_text = generic-normalized-text-content(text/back//biblStruct[1]/note[@type="raw_reference"])
first_reference_fields = generic-as-items(text/back//biblStruct[1], './/*')
first_reference_author_surnames = generic-as-items(text/back//biblStruct[1], './/author/persName/surname')
first_reference_author_given_names = generic-as-items(text/back//biblStruct[1], 'tei-given-name(.//author)')
first_reference_author_full_names = generic-as-items(text/back//biblStruct[1], 'tei-full-name(.//author)')
first_reference_title = generic-join-children(text/back//biblStruct[1], './/title[@level="a" or @level="m"]', ' ')
first_reference_year = generic-join-children(text/back//biblStruct[1], './/date[@type="published"]/@when', ' ')
first_reference_source = generic-join-children(text/back//biblStruct[1], './/title[@level="j"]', ' ')
first_reference_publication_type = generic-join-children(text/back//biblStruct[1], 'tei-ref-publication-type(.)', ' ')
first_reference_volume = generic-join-children(text/back//biblStruct[1], './/biblScope[@unit="volume"]', ' ')
first_reference_fpage = tei-ref-fpage(text/back//biblStruct[1])
first_reference_lpage = tei-ref-lpage(text/back//biblStruct[1])

reference_text = generic-normalized-text-content(text/back//biblStruct/note[@type="raw_reference"])
reference_fields = generic-as-items(text/back//biblStruct, './/*')
reference_author_surnames = generic-as-items(text/back//biblStruct, './/author/persName/surname')
reference_author_given_names = generic-as-items(text/back//biblStruct, 'tei-given-name(.//author)')
reference_author_full_names = generic-as-items(text/back//biblStruct, 'tei-full-name(.//author)')
reference_title = generic-join-children(text/back//biblStruct, './/title[@level="a"]', ' ')
reference_year = generic-join-children(text/back//biblStruct, './/date[@type="published"]/@when', ' ')
reference_source = generic-join-children(text/back//biblStruct, './/title[@level="j" or @level="m"]', ' ')
reference_publication_type = generic-join-children(text/back//biblStruct, 'tei-ref-publication-type(.)', ' ')
reference_volume = generic-join-children(text/back//biblStruct, './/biblScope[@unit="volume"]', ' ')
reference_fpage = tei-ref-fpage(text/back//biblStruct)
reference_lpage = tei-ref-lpage(text/back//biblStruct)

section_titles = text/body/div/head
section_paragraphs = text/body/div/p

keywords = teiHeader/profileDesc/textClass/keywords/term

# Note: the table contents will need to be mapped (but GROBID currently doesn't output any cells)
tables = text/body/figure[@type="table"]/table
table_strings = generic-text-content(text/body/figure[@type="table"]/table)
table_labels = text/body/figure[@type="table"]/head
table_captions = text/body/figure[@type="table"]/figDesc
table_label_captions = generic-concat-children(text/body/figure[@type="table"], '$head', ' ', '$figDesc')

figure_labels = text/body//figure[not(contains(@type, 'table'))]/head
figure_captions = text/body//figure[not(contains(@type, 'table'))]/figDesc
figure_label_captions = generic-concat-children(text/body//figure[not(contains(@type, 'table'))], '$head', ' ', '$figDesc')

[tei]
title = text/front/docTitle[1]/titlePart
abstract = text/front/div[@type="abstract"]
